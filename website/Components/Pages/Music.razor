@page "/music"
@using website.Models
@using website.Services
@inject DataService DataService
@layout Layout.MainLayout

<NavBar />

<h3 class="text-center text-4xl font-bold">MUSIC</h3>
<!-- Project List -->
    @if (_musicProjects.Count == 0)
    {
        <p class="text-neutral-500">No projects added yet.</p>
    }
    else
    {
        <div class="grid md:grid-cols-2 gap-6">
            @foreach (var project in _musicProjects.OrderByDescending(p => p.Date))
            {
                <div class="bg-neutral-900 border border-neutral-800 rounded-2xl p-6 shadow-md hover:shadow-lg transition-shadow duration-200">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h4 class="text-white font-semibold text-xl mb-1">@project.Title</h4>
                            <p class="text-neutral-500 text-sm">ðŸ“… @project.Date.ToString("yyyy-MM-dd")</p>
                        </div>
                    </div>

                    @if (!string.IsNullOrWhiteSpace(project.Description))
                    {
                        <p class="text-neutral-300 mb-3">@project.Description</p>
                    }

                    @if (!string.IsNullOrWhiteSpace(project.Link))
                    {
                        <a href="@project.Link" target="_blank"
                           class="text-blue-400 hover:text-blue-300 hover:underline mb-3 inline-block transition">
                            ðŸ”— Visit Link
                        </a>
                    }

                    @if (project.Tags.Any())
                    {
                        <div class="flex flex-wrap gap-2 mt-3">
                            @foreach (var tag in project.Tags)
                            {
                                <span class="bg-neutral-800 text-sm text-neutral-300 px-3 py-1 rounded-full">
                                    #@tag
                                </span>
                            }
                        </div>
                    }
                </div>
            }
        </div>
    }

@code {
    private List<MusicProject> _musicProjects = [];

    protected override async Task OnInitializedAsync()
    {
        try
        {
            var musicData = await DataService.LoadDataAsync<MusicData>("Music.json");
            _musicProjects = musicData?.Projects ?? [];
        }
        catch
        {
            _musicProjects = [];
        }
    }
}